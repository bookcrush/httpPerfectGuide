# HTTP

## 국제화

HTTP 는 여러 언어와 문자로 된 국제 문서들의 처리 및 전송을 지원해야 한다.

## 16.1 국제적인 콘텐츠를 다루기 위해 필요한 HTTP 지우너 

HTTP 메시지는 어떤 언어로 된 콘텐츠든 미디어처럼 실어 나를 수 있다. HTTP 에서 엔터티 본문이란 비트들로 가득 찬 상자에 불과하다.
국제 콘텐츠를 지원하기 위해, 서버는 클라이언트에게 문서의 문자와 언어를 알려줘서, 클라이언트가 올바르게 문서를 이루고 있는 비트들을 문자들로
풀어내고, 올바르게 처리해서 사용자에게 콘텐츠를 제공할 수 있도록 할 필요가 있다.

서버는 클라이언트에게 문서의 문자와 언어를 HTTP Content-Type charset 매개변수와 Content-Language 헤더를 통해 알려준다.
클라이언트는 서버에게 어떤 언어를 이해할 수 있고 알파벳의 코딩 알고리즘이 브라우저에 설치되어 있는지 Aceept-Charset, Accept-Language 를
이용하여 알려줄 필요가 있다.

```text
Accept-Language: fr, en;q=0.8
Accept-Charset: iso-8859-1, utf-8
```

## 16.2 문자집합과 HTTP

### 16.2.1 Charset 은 글자를 비트로 변환하는 인코딩이다

HTTP Charset 값은, 어떻게 엔터티 콘텐츠 비트들을 특정 문자 체계의 글자들로 바꾸는지 말해준다.
Charset 태그는 비트들을 글자들로 변환하거나 그 반대의 일을 해주는 알고리즘을 명명한다.

```text
Content-Type: text/html; charset=iso-8859-6
```

Content-type 헤더는 수신자에게 콘텐츠가 HTML 파일임을 말해주고, charset 매개변수는 수신자에게 콘텐츠 비트들을 그랒들로
디코딩하기 위해 ios-8859-6 아랍 문자집합 디코딩 기법을 사용하라고 말해준다.

ios-8859-6 인코딩 구조는 8비트 값을 숫자와 구두점 그리고 다른 기호들을 포함한 라틴 문자와 아랍 문자로 매핑한다.

### 16.2.2 문자집합과 인코딩은 어떻게 동작하는가 ?

- 문서를 이루는 비트들은, 특정 코딩된 문자집합의 특정 문자로 식별될 수 있는 문자 코드로 변환된다.
- 문자 코드는 코딩된 문자집합의 특정 요소를 선택하기 위해 사용된다.
- 단계에서 사용되는 알고리즘은 MIME charset 태그를 통해 결정된다.

국제화된 문자 시스템의 핵심 목표는 표현에서 의미를 분리하는 것이다.
HTTP 는 문자 데이터 및 그와 관련된 언어와 charset 라벨의 전송에만 관심을 갖는다.

### 16.2.3 잘못된 Charset 은 잘못된 글자들을 낳는다

클라이언트가 잘못된 charset 매개변수를 사용한다면, 클라이언트는 이상한 깨진 글자를 보여주게 될 것이다.

// 후에 그림 추가

### 16.2.4 표준화된 MIME Charset 값 

특정 문자 인코딩과 특정 코딩된 문자집합의 결합을 MIME Charset 이라고 부른다.
HTTP 는 표준화된 MIME Charset 태그를 Content-Type 과 Acccept-Charset 헤더에 사용한다.

[Character Sets](https://www.iana.org/assignments/character-sets/character-sets.xhtml)

### 16.2.5 Content-Type charset 헤더와 META 태그

```
Content-Type: text/html; charset=ios-2022-jp
```

웹 서버는 클라이언트에게 MIME Charset 태그를 charset 매개변수와 함께 Content-Type 에 담아 보낸다.
만약 문자집합이 명시적으로 나열되지 않았다면, 수신자는 문서의 콘텐츠로부터 문자집합을 추측하려 시도한다.
HTML Content 에서 문자 집합은 문자 집합을 서술하는 <META HTTP-EQUIV="Content-Type"> 태그에서 찾을 수 있다.
만약 클라이언트가 문자 인코딩을 추측하지 못했다면, iso-8859-1 인것으로 가정한다.

### 16.2.6 Accept-Charset 헤더 

대부분의 클라이언트는 모든 종류의 문자 코딩과 매핑 시스템을 지원하지 않는다.
HTTP 클라이언트는 서버에게 정확히 어떤 문자 체계를 그들이 지원하는지 Accept-Charset 요청 헤더를 통해 알려준다.
Accpt-Charset 헤더의 값은 클라이언트가 지원하는 문자 인코딩의 목록을 제공한다.
문자 인코딩 구조중 어떤 것으로 콘텐츠를 반환할지는 서버의 자유다.

Accept-Charset 요청 헤더에 대응하는 Content-Charset 응답 헤더는 존재하지 않는다.
응답 문자집합은 MIME 과의 호환을 위해 Content-Type 응답 헤더의 charset 매개변수를 통해 서버로부터 돌려받는다.

## 16.3 다중언어 문자 인코딩에 대한 지침

국제화 애플리케이션과 콘텐츠로 많은 작업을 하는 HTTP 프로그래머는 기술 명세를 이해하고 올바르게 소프트웨어를 구현하기 위해 
다중언어 문자집합 체계에 대해 깊이 이해할 필요가 있다.

### 16.3.1 문자집합 용어

- 문자: 글쓰기의 최소 단위, 약식으로 유니코드라고 불리는 국제 문자 세트
- 글리프: 하나의 글자를 표현하기 위한, 획의 패턴이나 다른 것과 구분되는 유일한 시각적 형태 
- 코딩된 문자: 글자를 다룰 수 있도록 글자에 할당된 유일한 숫자 
- 코드 공간: 문자 코드 값으로 사용하려고 계획해 둔 정수의 범위
- 코드 너비: 문자 코드의 비트 개수
- 사용 가능 문자 집합: 글자들에 대한 특정한 작업 집합
- 코딩된 문자집합: 사용 가능 문자집합을 받아서 각 글자에 코드 공간이 코드를 할당해주는 코딩된 문자들의 집합
- 문자 인코딩 구조: 숫자로 된 문자 코드들을 콘텐츠 비트의 연속으로 인코딩하는 알고리즘 

### 16.3.2 Charset 은 형편없는 이름이다

MIME Charset 태그는 문자집합을 의미하는 것이 결코 아니다. MIME Charset 값은 데이터 비트를 고유한 문자의 코드로 매핑하는 알고리즘의 이름이다.
이것은 문자 인코딩 구조와 코딩된 문자집합의 개념을 합친 것이다.
이 용어는 엉성하고 혼란스러운데, 이미 문자 인코딩 구조와 코딩된 문자집합에 대한 출판된 표준이 존재하기 때문이다. 

### 16.3.3 문자

문자 쓰기는 기분적인 구성요소다. 쓰기의 기본 단위를 표현한다.
문자는 글꼴이나 스타일에 독립적이다. 

### 16.3.4 글리프, 연자 그리고 표현 형태 

문자는 유일하고 추상화된 언어의 요소다. 글리프는 각 글자를 그리는 특정한 방법이다.
문자는 미적인 양식과 스크립트에 따라 여러 가지 글리프를 가진다.
문자와 그것의 표현 형태를 혼동하면 안된다. 쓰기를 보다 멋지게 보이도록 하기 위해, 많은 필기체와 활자체가 인접한
글자들이 부드럽게 이어지는 연자를 지원한다.

### 16.3.5 코딩된 문자집합

RFC 2277과 2130 에서 정의된 코딩된 문자집합은 정수를 글자로 대응시킨다.
코딩된 문자집합은 보통 코드 번호로 인덱싱된 배열로 구현된다.

[wikipedia](https://ko.wikipedia.org/wiki/ASCII)

### 16.3.6 문자 인코딩 구조

- 고정폭: 고정폭 인코딩은 각 코딩된 문자를 고정된 길이의 비트로 표현한다. 
- 가변폭 (비모달): 가변폭 인코딩은 다른 문자 코드 번호에 다른 길이의 비트를 사용한다. 자주 사용하는 글자의 비트 길이를 줄일 수 있고, 국제 문자에 대해서는
여러 바이트를 사용하도록 함으로써 이전 8 비트 문자집합과의 호환성도 유지할 수 있다.
- 가변폭 (모달): 모달 인코딩은 다른 모드로의 전환을 위해 특별한 'escape' 패턴을 사용한다. 모달 인코딩은 처리하기 복잡하지만, 복잡한 표기 체계를 효과적으로 지원해 줄 수 있다.
- 8비트: 8비트 고정폭 아이덴티티 인코딩은 간단히 각 문자 코드를 그에 대응하는 8비트 값으로 인코딩한다. iso-8859 문자 집합군은 8 비트 아이덴티티 인코딩을 사용한다.
- UTF-8: UTF-8 은 인기 있는 UCS 를 위해 설계된 문자 인코딩 구조다. UTF-8 은 문자 코드의 값을 위해 비모달 가변길이 인코딩을 사용한다.
첫 바이트의 선두 비트들은 이코딩된 문자의 길이를 바이트 단위로 나타내고, 그 이후의 바이트들은 각각 6 비트의 코드 값을 담는다.
- iso-2022-jp: [참고](https://ko.wikipedia.org/wiki/ISO/IEC_2022)
- euc-jp: [참고](https://ko.wikipedia.org/wiki/%ED%99%95%EC%9E%A5_%EC%9C%A0%EB%8B%89%EC%8A%A4_%EC%BD%94%EB%93%9C)
- euc-kr: [참고](https://ko.wikipedia.org/wiki/EUC-KR)

## 16.4 언어 태그와 HTTP

언어 태그는 언어에 이름을 붙이기 위한 짧고 표준화된 문자열이다.
언어 태그는 지역에 따라 변형된 언어나 방언을 표현할 수 있다.

### 16.4.1 Content-Language 헤더 

Content-Language 엔터티 헤더 필드는 엔터티가 어떤 언어 사용자를 대상으로 하고 있는지 서술한다.
Content-Language 헤더는 텍스트 문서만을 위한 것이 아니다. 오디오 클립, 동영상, 애플리케이션도 특정 언어 사용자를 대상으로 할 수 있다.

### 16.4.2 Accept-Language 헤더

HTTP 는 우리에게 우리의 언어 제약과 선호도를 웹 서버에 전달할 수 있게 해준다. 웹 서버가 어떤 자원에 대해 여러 언어로 된 버전을
갖고 있다면, 웹 서버는 우리가 선호하는 언어로 된 콘텐츠를 줄 수 있다.

### 16.4.3 언어 태그의 종류 

언어 태그는 PFC 3066 로 문서화된 표준화된 문법을 갖고 있다. 

- 일반적인 언어의 종류, 특정 국가의 언어, 방언, 지방어, 다른 언어의 변형이 아닌 표준 언어, 비표준 언어 

### 16.4.4 서브태그

언어 태그는 하이픈으로 분리된 하나 이상의 서브태그로 이루어져 있다.
서브태그는 A-Z 까지의 글자만을 포함한다.

- 첫 번째 서브태그는 주 서브태그라 불린다. 이 값들은 표준화되어 있다.
- 두 번째 서브태그는 선택적이고 자신만의 이름 표준을 따른다.
- 세 번째부터의 서브 태그는 등록되어 있지 않다.

### 16.4.5 대소문자의 구분 및 표현 

모든 태그는 대소문자가 구분되지 않는다. 태그 'en' 과 'eN' 은 같다.
그러나 관용적으로 언어를 나타낼 떄는 소문자를 사용하고, 국가를 나타낼 떄는 대문자를 사용한다.

### 16.4.6 IANA 언어 태그 등록

첫 번쨰와 두 번째 언어 서브태그의 값은 여러 가지 표준 문서와 그것들을 관리하는 조직에 의해서 정의된다.
IANA 는 RFC 3066 의 규칙에 따라 표준 언어 태그의 목록을 관리한다.

### 16.4.7 첫 번째 서브태그: 이름공간

첫 번째 서브태그는 보통 ISO 639 표준 언어 집합에서 선택된 표준화된 언어 토큰이다.
그러나 또한 IANA 에서 등록한 이름을 의미하는 글자 'i' 일 수도 있고, 특정 집단의 전용 확장 이름임을 의미하는 'x' 일 수도 있다.

- 두 글자라면 ISO 639 와 639-1 표준의 언어 코드다
- 세 글자라면 ISO 639-2 표준과 확장에 열거된 언어 코드다
- 글자 'i' 라면 이 언어 태그는 틀립없이 IANA 에 등록된 것이다
- 글자 'x' 라면 이 언어 태그는 특정 개인이나 집단 전용의 비표준 확장 서브태그다

### 16.4.8 두 번째 서브태그: 이름공간

두 번째 서브태그는 보통 ISO 3166 국가 코드와 지역 표준 집합에서 선택된 표준화 된 국가 토큰이다. IANA 에 등록된 다른 문자열일 수도 있다.

- 두 글자라면, ISO 3166 에 정의된 국가/지역이다.
- 3 ~ 8 글자라면, IANA 에 등록된 것이다.
- 한 글자라면, 뭔가 잘못된 것이다.

### 16.4.9 나머지 서브태그: 이름공간

세 번째와 그 이후의 서브태그에 대해서는, 8자 이하의 알파벳과 숫자가 이루어져야 한다는 것을 제외하면 다른 규칙은 없다.

### 16.4.10 선호 언어 설정하기

웹 브라우저 프로필에서 선호 언어를 선택할 수 있다.

## 16.5 국제화된 URI

오늘날 URI 는 국제화를 그다지 지원하지 않는다. 몇 가지 예외와 함께, 오늘날의 URI 는 US-ASCII의 부분집합으로 구성되어 있다.
호스트명과 URI의 경로에 더 풍부한 문자집합을 포함할 수 있게 하려는 노력이 진행중이지만, 이러한 표준은 널리 받아들여지지도
사용되지도 않고 있다.

### 16.5.1 국제적 가독성 vs 의미 있는 문자들

URI 설계자들은 전 세계의 모두가 URI 를 이메일, 전화, 광고판, 라디오 등을 통해 다른 이들과 공유할 수 있기를 원했다.
그들은 URI 가 사용하기 쉽소 기억하기 쉽길 바랐다.
공유하기 쉽게 설계자들은 제한된 공통 문자집합을 선택했다.
불행히도 문자집합에는 제한이 있기 떄문에, URI 는 비영어권 사람들도 쉽게 사용하고 기억할 수 있도록 그들의 문자로 만들 수 있게 설계되지는 못했다.
URI 저자들은 리소스 식별자의 가독성과 공유 가능성의 보장이, 대부분의 의미 있는 문자들로 구성될 수 있도록 하는 것보다 더 중요하다고 여겼다.
그래서 우리들은 ASCII 문자들의 제한된 집합으로 이루어진 URI 를 갖게되었다.

### 16.5.2 URI 에서 사용될 수 있는 문자들

URI 에서 사용할 수 있는 US-ASCII 문자들의 부분집합은 예약된 문자들, 예약되지 않은 문자들, 이스케이프 문자들로 나뉜다.
예약되지 않은 문자들은 그것들을 허용하는 URI 의 어떤 구성요소에서든 일반적으로 사용될 수 있다.

### 16.5.3 이스케이핑과 역 이스케이핑 







































